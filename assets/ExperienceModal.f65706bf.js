import{_ as B,d as N,T as P,U as J,V as A,g as q,W as z,s as F}from"./index.89e2cf0c.js";import{d as H,C as L,r as p,J as h,f as g,o as R,g as W,h as l,D as _,H as f,u as w,j as G,x as K,M as Q,m as X,n as Z,q as $}from"./vendor.a132856b.js";import{d as s}from"./dayjs.9461779c.js";const i=c=>(X("data-v-07f50f7d"),c=c(),Z(),c),ee=["onClick"],te={class:"experience-modal"},ae=i(()=>l("h3",{class:"modal-title"},"experience",-1)),le=i(()=>l("span",null,"image",-1)),oe={class:"img-upload-group"},ne=["src"],se=i(()=>l("span",null,"experience title",-1)),re=i(()=>l("span",null,"work place",-1)),ie=i(()=>l("span",null,"work time",-1)),ce={class:"time-group"},ue=$(" - "),de=["max"],pe=i(()=>l("span",{class:"content"},"content",-1)),me=H({props:{experience:{type:Object,default:()=>({})}},emits:["setTempExperience"],setup(c,{expose:E,emit:y}){const T=c,k=L(()=>N(()=>import("./Editor.e3e55e56.js"),["assets/Editor.e3e55e56.js","assets/Editor.1cebcf8b.css","assets/vendor.a132856b.js","assets/index.89e2cf0c.js","assets/index.491beacd.css"])),{updateUserProfile:x}=F,m=p(),t=p({});h(()=>T.experience,o=>{t.value=JSON.parse(JSON.stringify(o)),m.value.setText(t.value.content),o&&t.value.start_time&&t.value.end_time?(n.value.workTimeStart=s(t.value.start_time*1e3).format("YYYY-MM-DD"),n.value.workTimeEnd=s(t.value.end_time*1e3).format("YYYY-MM-DD")):(n.value.workTimeStart="",n.value.workTimeEnd="")});const n=p({workTimeStart:"",workTimeEnd:""}),M=g(()=>s().format("YYYY-MM-DD")),v=p(!1),D=()=>v.value=!0,u=()=>v.value=!1,d=p("create"),S=g(()=>{if(d.value==="create")return!1;if(d.value==="update")return!0}),Y=()=>{d.value==="create"?U():d.value==="update"&&b()},U=async()=>{const o={title:t.value.title,start_time:Math.floor(s(n.value.workTimeStart).valueOf()/1e3),end_time:Math.floor(s(n.value.workTimeEnd).valueOf()/1e3),image_url:t.value.image_url,place:t.value.place,content:m.value.getText()};try{const{data:a}=await P(o),{experience:e}=a;x({experience:e}),u()}catch(a){alert("create failed")}},b=async()=>{const{id:o}=t.value;if(!o)return;const a={title:t.value.title,start_time:Math.floor(s(n.value.workTimeStart).valueOf()/1e3),end_time:Math.floor(s(n.value.workTimeEnd).valueOf()/1e3),image_url:t.value.image_url,place:t.value.place,content:m.value.getText()};try{const{data:e}=await J(o,a),{experience:r}=e;x({experience:r}),u()}catch(e){alert("update failed")}},C=async()=>{const{id:o}=t.value;if(!!o)try{const{data:a}=await A(o),{experience:e}=a;x({experience:e}),u()}catch(a){console.dir(a)}};h(v,o=>{o?document.body.style.overflow="hidden":(document.body.style.overflow="auto",y("setTempExperience",{}))});const I=o=>d.value=o,V=()=>t.value.image_url?t.value.image_url:q("upload_cloud"),j=async o=>{const a=o.target.files[0],e=new FormData;e.append("img-file",a);try{const{data:r}=await z(e),{imgUrl:O}=r;t.value.image_url=O}catch(r){alert("upload failed")}};return E({showModal:D,setStatus:I}),(o,a)=>(R(),W("div",{class:K(["experience-modal-container",{show:v.value}]),onClick:Q(u,["self"])},[l("div",te,[ae,l("label",null,[le,l("div",oe,[l("img",{src:V(),alt:"experience"},null,8,ne),l("input",{type:"file",onChange:a[0]||(a[0]=e=>j(e))},null,32)])]),l("label",null,[se,_(l("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>t.value.title=e)},null,512),[[f,t.value.title]])]),l("label",null,[re,_(l("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>t.value.place=e)},null,512),[[f,t.value.place]])]),l("label",null,[ie,l("div",ce,[_(l("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=e=>n.value.workTimeStart=e)},null,512),[[f,n.value.workTimeStart]]),ue,_(l("input",{type:"date",max:w(M),"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.workTimeEnd=e)},null,8,de),[[f,n.value.workTimeEnd]])])]),l("label",null,[pe,G(w(k),{ref:(e,r)=>{r.editorEl=e,m.value=e},deleteBtn:w(S),onCancel:u,onUpdate:Y,onDelete:C},null,8,["deleteBtn"])])])],10,ee))}});var xe=B(me,[["__scopeId","data-v-07f50f7d"]]);export{xe as default};
