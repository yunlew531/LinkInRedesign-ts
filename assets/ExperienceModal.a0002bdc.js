import{_ as B,d as N,T as P,U as A,V as J,g as q,W as z,l as F}from"./index.9fe55531.js";import{d as H,C as K,r as p,H as h,f as g,o as L,g as R,h as l,D as _,M as f,u as w,j as W,x as G,K as Q,m as X,n as Z,q as $}from"./vendor.d65808b7.js";import{d as s}from"./dayjs.19e4cc98.js";const i=c=>(X("data-v-6ffdcb10"),c=c(),Z(),c),ee=["onClick"],te={class:"experience-modal"},ae=i(()=>l("h3",{class:"modal-title"},"experience",-1)),le=i(()=>l("span",null,"image",-1)),oe={class:"img-upload-group"},ne=["src"],se=i(()=>l("span",null,"experience title",-1)),re=i(()=>l("span",null,"work place",-1)),ie=i(()=>l("span",null,"work time",-1)),ce={class:"time-group"},de=$(" - "),ue=["max"],pe=i(()=>l("span",{class:"content"},"content",-1)),me=H({props:{experience:{type:Object,default:()=>({})}},emits:["setTempExperience"],setup(c,{expose:E,emit:y}){const T=c,k=K(()=>N(()=>import("./Editor.305e655c.js"),["assets/Editor.305e655c.js","assets/Editor.19f2fc4b.css","assets/vendor.d65808b7.js","assets/index.9fe55531.js","assets/index.491beacd.css"])),{updateUserProfile:x}=F,m=p(),t=p({});h(()=>T.experience,o=>{t.value=JSON.parse(JSON.stringify(o)),m.value.setText(t.value.content),o&&t.value.start_time&&t.value.end_time?(n.value.workTimeStart=s(t.value.start_time*1e3).format("YYYY-MM-DD"),n.value.workTimeEnd=s(t.value.end_time*1e3).format("YYYY-MM-DD")):(n.value.workTimeStart="",n.value.workTimeEnd="")});const n=p({workTimeStart:"",workTimeEnd:""}),M=g(()=>s().format("YYYY-MM-DD")),v=p(!1),D=()=>v.value=!0,d=()=>v.value=!1,u=p("create"),S=g(()=>{if(u.value==="create")return!1;if(u.value==="update")return!0}),Y=()=>{u.value==="create"?b():u.value==="update"&&U()},b=async()=>{const o={title:t.value.title,start_time:Math.floor(s(n.value.workTimeStart).valueOf()/1e3),end_time:Math.floor(s(n.value.workTimeEnd).valueOf()/1e3),image_url:t.value.image_url,place:t.value.place,content:m.value.getText()};try{const{data:a}=await P(o),{experience:e}=a;x({experience:e}),d()}catch(a){alert("create failed")}},U=async()=>{const{id:o}=t.value;if(!o)return;const a={title:t.value.title,start_time:Math.floor(s(n.value.workTimeStart).valueOf()/1e3),end_time:Math.floor(s(n.value.workTimeEnd).valueOf()/1e3),image_url:t.value.image_url,place:t.value.place,content:m.value.getText()};try{const{data:e}=await A(o,a),{experience:r}=e;x({experience:r}),d()}catch(e){alert("update failed")}},C=async()=>{const{id:o}=t.value;if(!!o)try{const{data:a}=await J(o),{experience:e}=a;x({experience:e}),d()}catch(a){console.dir(a)}};h(v,o=>{o?document.body.style.overflow="hidden":(document.body.style.overflow="auto",y("setTempExperience",{}))});const I=o=>u.value=o,V=()=>t.value.image_url?t.value.image_url:q("upload_cloud"),j=async o=>{const a=o.target.files[0],e=new FormData;e.append("img-file",a);try{const{data:r}=await z(e),{imgUrl:O}=r;t.value.image_url=O}catch(r){alert("upload failed")}};return E({showModal:D,setStatus:I}),(o,a)=>(L(),R("div",{class:G(["experience-modal-container",{show:v.value}]),onClick:Q(d,["self"])},[l("div",te,[ae,l("label",null,[le,l("div",oe,[l("img",{src:V(),alt:"experience"},null,8,ne),l("input",{type:"file",onChange:a[0]||(a[0]=e=>j(e))},null,32)])]),l("label",null,[se,_(l("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>t.value.title=e)},null,512),[[f,t.value.title]])]),l("label",null,[re,_(l("input",{type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>t.value.place=e)},null,512),[[f,t.value.place]])]),l("label",null,[ie,l("div",ce,[_(l("input",{type:"date","onUpdate:modelValue":a[3]||(a[3]=e=>n.value.workTimeStart=e)},null,512),[[f,n.value.workTimeStart]]),de,_(l("input",{type:"date",max:w(M),"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.workTimeEnd=e)},null,8,ue),[[f,n.value.workTimeEnd]])])]),l("label",null,[pe,W(w(k),{ref:(e,r)=>{r.editorEl=e,m.value=e},deleteBtn:w(S),onCancel:d,onUpdate:Y,onDelete:C},null,8,["deleteBtn"])])])],10,ee))}});var xe=B(me,[["__scopeId","data-v-6ffdcb10"]]);export{xe as default};
